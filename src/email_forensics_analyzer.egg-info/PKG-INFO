Metadata-Version: 2.4
Name: email-forensics-analyzer
Version: 1.0.0
Summary: Email Forensics Analyzer prototype (MBOX/PST).
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: python-dateutil>=2.8.2

# Email Forensics Analyzer (Digital Forensics Project)

A working **Email Forensics Analyzer** prototype that:

- Parses **MBOX** mailboxes (and **PST → MBOX** conversion via `readpst` is supported).
- Extracts key **email headers** into structured outputs.
- Detects common **spoofing / phishing indicators** (SPF/DKIM/DMARC failures, domain mismatches, suspicious routing patterns).
- Builds **sender/receiver interaction** summaries (who talks to whom, counts, timeline).
- Extracts **attachments + metadata** and computes hashes (MD5/SHA-256) for evidentiary handling.

## 1) Quick Start

### Option A — Recommended (virtual environment)
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
# Option 1: run without installing
./run.sh --help
# Option 2: install as a package (recommended)
pip install -e .
email-forensics-analyzer --help
```

### Option B — Kali/Debian packages (minimal)
You can run with **stdlib only**, but some features improve if you install:
```bash
sudo apt update
sudo apt install -y pst-utils exiftool
```

## 2) Run the Analyzer

### Analyze an MBOX
```bash
python3 -m email_forensics_analyzer analyze --input sample.mbox --out out_case1
```

### Analyze a PST (auto convert using readpst)
```bash
sudo apt install -y pst-utils
python3 -m email_forensics_analyzer analyze --input mailbox.pst --out out_case_pst
```

### Narrow analysis to a suspected phishing campaign (optional filters)
```bash
python3 -m email_forensics_analyzer analyze \
  --input sample.mbox \
  --out out_phish \
  --filter-from "security@" \
  --filter-subject "urgent" \
  --max-emails 500
```

## 3) Outputs Produced

Inside your `--out` folder:

- `emails.csv` — one row per email (dates, sender, recipients, subject, message-id…)
- `headers.jsonl` — extracted header fields (structured)
- `spoofing_report.csv` — per-email indicator flags + a numeric risk score
- `campaigns.csv` — simple clustering by normalized subject + sender domain
- `interactions.csv` — sender → recipient edges, counts, first/last seen
- `attachments/` — extracted attachments (organized by message-id hash)
- `attachments_report.csv` — attachment metadata + hashes (+ optional exiftool results)

## 4) Test Data (Legal/Public)

You can test with public datasets (do **not** use private mailboxes without permission):

- **Enron Email Dataset** (large, realistic mail corpus; available via CMU and Kaggle).  
- **EnronData.org PST mailboxes** (PSTs per custodian).  
- **SpamAssassin Public Corpus** (spam/ham, good for phishing-like content tests).  
- **Phishing emails (MBOX) on Kaggle** (explicit phishing-focused MBOX collection).

See `REPORT_TEMPLATE.md` for suggested evaluation steps and what screenshots/tables to include in your submission.

## 5) Notes for Submission

- The prototype is designed to be **repeatable**: you can rerun analysis and regenerate outputs.
- Forensic hygiene: the tool **does not modify** the input mailbox; it only reads it.
- Hashing (MD5/SHA-256) is included to support integrity checks for extracted attachments.

---

## License
Educational prototype for coursework.


## GUI

Run the graphical interface (shows emails, spoofing indicators, headers, interactions, attachments, campaigns):

```bash
# On Debian/Kali if tkinter is missing:
sudo apt install -y python3-tk

# Run without installing:
./run_gui.sh

# Or, after installing the package:
email-forensics-gui
```
